<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <title>Document </title>

    <script>
    //Second box should show after the response comes back 
    //This is the new ajax call - 

    //Questions to ask tutor -
        //When we put the new text into the first box and there are no grammar errors it does not display the synnonym changes from the spinbot API
    //We need to add the text that comes back from the Grammar API and send it to a dictionary API. 
        //We just need to capture the results and create a function to call the API with the stored data. 
        
    
    function grammar(argument) {
            // MAKE REQUEST
        // var text = $("#firstBox").val().trim();

        var queryURL = "https://api.textgears.com/check.php?text=" + argument + "&key=UTwhCrerzebHa6Bh";
        var text = argument

        $.ajax({
        method: "GET",
        url: queryURL
        }).then(function (response) {
            console.log(response);
            if (response.errors.length == 0) {
                console.log("There are no errors!");
            } else {
                console.log("Errors exist");
                for (var i = 0; i < response.errors.length; i++) {
                    console.log(response.errors[i].bad.length);
                    if (response.errors[i].bad.length > 1) {
                    text = text.replace(response.errors[i].bad, response.errors[i].better[0]);
                    console.log(text)
                    $("#secondBox").text(text);
                    }
                }
            }
        })
    };

    //This is the function for calling the grammar AJAX.
    // grammar(text)

    $(document).ready(function(){
        $("#newText").on("click",function(){

        var text = $("#firstBox").val()

        $.ajax({method:"post" , url: "http://api.spinbot.net/api/spinner?key=092deb0523426e92f62a15eae82d012c&text="+text})
        .then(function(response){
            console.log(response);
            //change made here grammar
            grammar(response.spun_text)
            // $("#secondBox").val(response.spun_text)
        
            //.show whatever ID the new button is, which means it needs to hide when the page loads
            //For second call to new API, we would use $(#secondBox).val
            //You can create a div and pass through the value of which words were changed using replace_terms
            })
        })
    });        
//     </script>

// </head>
// <body>

// <textarea name="Text-Area" id="firstBox" cols="30" rows="10"></textarea>
// <button id = "newText">New Text</button>
// <textarea name="Response-Area" id="secondBox" cols="30" rows="10"></textarea>   

// </body>
// </html>