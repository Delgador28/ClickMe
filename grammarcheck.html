<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">

  <title>Grammar Check</title>
</head>

<body>


  <!-- Insert materialize portion instead of bootstrap  -->

  <div id="nav">
    <div class="slider">
      <ul class="slides">
        <li>
          <img src="assets/images/write.jpg">
          <!-- random image -->
          <div class="caption center-align">
            <h3>Check It ✓</h3>
            <h5 class="light grey-text text-lighten-3">The coolest tool in school</h5>
          </div>
        </li>
        <li>
          <img src="assets/images/write.jpg">
          <!-- random image -->
          <div class="caption left-align">
            <h3>What is Check It ✓?</h3>
            <h5 class="light grey-text text-lighten-3">Check It ✓ is a fundamental tool made for anyone struggling to write, giving synonyms, grammar checks, and defintions,
              all in one!</h5>
          </div>
        </li>
      </ul>
    </div>
  </div>




  <!-- Panel one, where your original paper shall go -->
  <div id="all">
    <div class="row">
      <div class="col s12 m6">
        <div class="card grey darken-1 z-depth-5">
          <span class="card-title">Original:</span>
          <div class="row">
            <form class="col s12">
              <div class="row">
                <div class="input-field col s12">
                  <textarea id="firstBox" class="materialize-textarea" placeholder="Click here to start your original copy..."></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>


      <!--Panel 3 with changes fixed-->

      <div class="col s12 m6">
        <div class="card grey darken-1 z-depth-5">
          <span class="card-title">Final:</span>
          <div class="row">
            <form class="col s12">
              <div class="row">
                <div class="input-field col s12">
                  <textarea id="secondBox" class="materialize-textarea" placeholder="Final copy will appear here..."></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>



  <div id="buttons">
    <div class="row">

      <container id="newText">
        <a class="waves-effect waves-light btn grey darken-1 z-depth-5">Check Me ✓</a>
      </container>
    </div>
    <div class="row">
      <container id="clear">
        <a class="waves-effect waves-light btn grey darken-1 z-depth-5"> Clear </a>
      </container>
    </div>
  </div>





  <!-- Make panel in middle with mistakes found in paper  Panel 2-->

  <!--Panel 3 with changes from api being displayed-->
  <div id="last">
    <div class="row">
      <div class="col s12 m6">
        <div class="card grey darken-1 z-depth-5">
          <div class="row">
            <form class="col s12">
              <div class="row">
                <div class="input-field col s12">
                  <textarea id="word" class="materialize-textarea" placeholder="Insert Word..."></textarea>
                  <textarea id="definition" class="materialize-textarea" placeholder="Results..."></textarea>
                </div>
              </div>
            </form>
          </div>
        </div>



        <div id="button">
          <div class="row">
            <container id="search">
              <a class="waves-effect waves-light btn grey darken-1 z-depth-5"> Search It </a>
            </container>
          </div>
        </div>
      </div>
    </div>


    <!-- Button to 'searching the web' code that brian made-->




    <!-- JAVASCRIPT -->



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

    <!-- ================================================================== -->

    <script>

      $("#clear").click(function () {
        $("textarea").val("");
      });

      $(document).ready(function () {
        $('.slider').slider();
      });



      // Pause slider
      $('.slider').slider('pause');
      // Start slider
      $('.slider').slider('start');
      // Next slide
      $('.slider').slider('next');
      // Previous slide
      $('.slider').slider('prev');


      // ================================================================== -->

      function grammar(argument) {
        // MAKE REQUEST
        // var text = $("#firstBox").val().trim();

        var queryURL = "https://api.textgears.com/check.php?text=" + argument + "&key=UTwhCrerzebHa6Bh";
        var text = argument

        $.ajax({
          method: "GET",
          url: queryURL
        }).then(function (response) {
          console.log(response);
          if (response.errors.length == 0) {
            console.log("There are no errors!");
          } else {
            console.log("Errors exist");
            for (var i = 0; i < response.errors.length; i++) {
              console.log(response.errors[i].bad.length);
              if (response.errors[i].bad.length > 1) {
                text = text.replace(response.errors[i].bad, response.errors[i].better[0]);
                console.log(text)
                $("#secondBox").text(text);
              }
            }
          }
        })
      };

      //This is the function for calling the grammar AJAX.
      // grammar(text)

      $(document).ready(function () {
        $("#newText").on("click", function () {

          var text = $("#firstBox").val()

          $.ajax({ method: "post", url: "http://api.spinbot.net/api/spinner?key=092deb0523426e92f62a15eae82d012c&text=" + text })
            .then(function (response) {
              console.log(response);
              //change made here grammar
              grammar(response.spun_text)

              //.show whatever ID the new button is, which means it needs to hide when the page loads
              //For second call to new API, we would use $(#secondBox).val
              //You can create a div and pass through the value of which words were changed using replace_terms
            })
        })
      });



    </script>

</body>

</html>